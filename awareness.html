<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script>try{var k='theme',s=localStorage.getItem(k),h=(new Date).getHours(),a=(h>=6&&h<18)?'light':'dark';document.documentElement.dataset.theme=s||a;}catch(e){}</script>
  <style>
*{margin:0;padding:0;box-sizing:border-box}html,body{height:100%}:root[data-theme='light']{--bg:#f5f5f5;--text:#333;--link:#000;--primary-color:#7917e8;--secondary-color:#fff;--tertiary-color:#ccc;--quaternary-color:#fff;--card-bg:rgba(121,23,232,.1);--shadow:0 4px 12px rgba(0,0,0,.2);--separator-shine:rgba(255,255,255,.8);--warning:#e85d04;--success:#2d6a4f;--info:#0077b6;--glow:rgba(121,23,232,.3);--danger:#d00000}:root[data-theme='dark']{--bg:#0b0b0f;--text:#e6e6e6;--link:#e6e6e6;--primary-color:#a783ff;--secondary-color:#0f0f14;--tertiary-color:#2a2a33;--quaternary-color:#15151b;--card-bg:rgba(167,131,255,.12);--shadow:0 6px 16px rgba(0,0,0,.45);--separator-shine:rgba(255,255,255,.35);--warning:#f48c06;--success:#40916c;--info:#48cae4;--glow:rgba(167,131,255,.4);--danger:#ff6b6b}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:16px;line-height:1.6;color:var(--text);background:var(--bg);position:relative;overflow-x:hidden;letter-spacing:-.2px}a{color:var(--link);font-size:1rem;text-decoration:none;border-bottom:1px dotted}section{padding:5%}h1{font-size:2.5rem;font-weight:700;letter-spacing:-.5px;line-height:1.2}h2{font-size:1.5rem;font-weight:600;line-height:1.3;padding:1rem 0;letter-spacing:-.3px}h3{font-size:1.2rem;font-weight:600;line-height:1.4;letter-spacing:-.2px}nav{display:flex;align-items:center;justify-content:space-between}.theme-toggle{cursor:pointer;border:1px solid var(--tertiary-color);background:var(--quaternary-color);color:var(--text);border-radius:999px;padding:.5rem .75rem;box-shadow:var(--shadow);transition:transform .1s ease,background .2s ease,color .2s ease,border-color .2s ease}.theme-toggle:hover{transform:translateY(-1px)}.theme-toggle:active{transform:translateY(0)}.back-link{font-size:.9rem;color:var(--primary-color);border-bottom:none}.back-link:hover{opacity:.8}.container{max-width:1200px;margin:0 auto;padding:2rem 1rem}.header{text-align:center;margin-bottom:2rem}.header h1{margin-bottom:.5rem}.header p{color:var(--text);opacity:.8;max-width:600px;margin:0 auto}.cyber-separator{width:100%;max-width:600px;height:3px;margin:1.5rem auto;background:linear-gradient(90deg,transparent 0%,color-mix(in oklab,var(--primary-color) 20%,transparent) 15%,var(--primary-color) 50%,color-mix(in oklab,var(--primary-color) 20%,transparent) 85%,transparent 100%);position:relative;overflow:hidden}.cyber-separator::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,var(--separator-shine),transparent);animation:shine 3s infinite}@keyframes shine{to{left:100%}}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem;margin-top:2rem}.card{background:var(--card-bg);border-radius:12px;padding:1.5rem;border-left:4px solid var(--primary-color);box-shadow:var(--shadow);transition:transform .2s ease,box-shadow .2s ease}.card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.2)}.card h2{margin:0 0 1rem 0;padding:0;display:flex;align-items:center;gap:.5rem;font-size:1.25rem}.card-icon{font-size:1.5rem}.card.danger-card{border-left-color:var(--danger)}.card.warning-card{border-left-color:var(--warning)}.data-row{display:flex;justify-content:space-between;align-items:flex-start;padding:.6rem 0;border-bottom:1px solid var(--tertiary-color)}.data-row:last-child{border-bottom:none}.data-label{font-weight:500;color:var(--text);opacity:.7;font-size:.9rem;flex-shrink:0}.data-value{text-align:right;word-break:break-word;max-width:60%;font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.85rem;color:var(--primary-color)}.data-value.danger{color:var(--danger)}.data-value.warning{color:var(--warning)}.loading{color:var(--text);opacity:.5;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:.5}50%{opacity:1}}.ip-highlight{font-size:1.5rem;font-weight:700;text-align:center;padding:1rem;background:linear-gradient(135deg,var(--primary-color),color-mix(in oklab,var(--primary-color) 70%,#fff));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.warning-banner{background:linear-gradient(135deg,rgba(232,93,4,.15),rgba(232,93,4,.05));border:1px solid var(--warning);border-radius:8px;padding:1rem 1.5rem;margin:2rem 0;text-align:center}.warning-banner h3{color:var(--warning);margin-bottom:.5rem}.fingerprint-display{font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.7rem;word-break:break-all;background:var(--secondary-color);padding:.75rem;border-radius:6px;margin-top:.5rem;border:1px solid var(--tertiary-color)}.progress-bar{width:100%;height:6px;background:var(--tertiary-color);border-radius:3px;overflow:hidden;margin:1rem 0}.progress-fill{height:100%;background:linear-gradient(90deg,var(--primary-color),color-mix(in oklab,var(--primary-color) 60%,#fff));border-radius:3px;transition:width .3s ease;box-shadow:0 0 10px var(--glow)}.status-indicator{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:.5rem}.status-yes{background:var(--success);box-shadow:0 0 8px var(--success)}.status-no{background:var(--warning);box-shadow:0 0 8px var(--warning)}.status-danger{background:var(--danger);box-shadow:0 0 8px var(--danger)}.footer{text-align:center;margin-top:3rem;padding:2rem;opacity:.7;font-size:.9rem}.scan-animation{position:relative;overflow:hidden}.scan-animation::after{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(167,131,255,.1),transparent);animation:scan 2s ease-in-out infinite}@keyframes scan{to{left:100%}}.refresh-btn{background:var(--primary-color);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:8px;cursor:pointer;font-size:1rem;margin-top:1rem;transition:transform .1s ease,opacity .2s ease}.refresh-btn:hover{opacity:.9;transform:translateY(-1px)}.refresh-btn:active{transform:translateY(0)}.extension-list{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.extension-tag{background:var(--secondary-color);border:1px solid var(--tertiary-color);padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-family:'SF Mono',Monaco,Consolas,monospace}.extension-tag.detected{background:rgba(208,0,0,.15);border-color:var(--danger);color:var(--danger)}.extension-tag.privacy-risk{background:rgba(248,140,6,.15);border-color:var(--warning);color:var(--warning)}.font-list{font-size:.75rem;max-height:100px;overflow-y:auto;background:var(--secondary-color);padding:.5rem;border-radius:4px;border:1px solid var(--tertiary-color);margin-top:.5rem}.social-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:.5rem;margin-top:.5rem}.social-item{display:flex;align-items:center;gap:.5rem;padding:.4rem .6rem;background:var(--secondary-color);border-radius:6px;font-size:.8rem;border:1px solid var(--tertiary-color)}.social-item.logged-in{background:rgba(208,0,0,.1);border-color:var(--danger)}.social-item .social-icon{font-size:1rem}.storage-inspector{margin-top:.75rem}.storage-section{margin-bottom:1rem}.storage-section h4{font-size:.85rem;margin-bottom:.5rem;opacity:.8;display:flex;align-items:center;gap:.5rem}.storage-section h4 .count{background:var(--primary-color);color:#fff;padding:.1rem .4rem;border-radius:4px;font-size:.7rem}.storage-list{background:var(--secondary-color);border:1px solid var(--tertiary-color);border-radius:6px;max-height:150px;overflow-y:auto;font-size:.75rem}.storage-item{padding:.5rem .75rem;border-bottom:1px solid var(--tertiary-color);display:flex;flex-direction:column;gap:.25rem}.storage-item:last-child{border-bottom:none}.storage-key{font-weight:600;color:var(--primary-color);font-family:'SF Mono',Monaco,Consolas,monospace;word-break:break-all}.storage-value{color:var(--text);opacity:.8;font-family:'SF Mono',Monaco,Consolas,monospace;word-break:break-all;max-height:60px;overflow:hidden;text-overflow:ellipsis}.storage-item.sensitive{background:rgba(208,0,0,.08)}.storage-item.sensitive .storage-key{color:var(--danger)}.sensitive-badge{display:inline-block;background:var(--danger);color:#fff;font-size:.6rem;padding:.1rem .3rem;border-radius:3px;margin-left:.5rem;text-transform:uppercase}.storage-empty{padding:.75rem;text-align:center;opacity:.6;font-style:italic}.threat-intel{margin-top:1rem;padding-top:.75rem;border-top:1px dashed var(--tertiary-color)}.threat-toggle{background:none;border:1px solid var(--tertiary-color);color:var(--text);padding:.4rem .75rem;border-radius:6px;font-size:.75rem;cursor:pointer;display:flex;align-items:center;gap:.4rem;opacity:.8;transition:all .2s ease}.threat-toggle:hover{opacity:1;border-color:var(--primary-color)}.threat-toggle .arrow{transition:transform .2s ease;font-size:.6rem}.threat-toggle.open .arrow{transform:rotate(90deg)}.threat-content{display:none;margin-top:.75rem;font-size:.8rem;line-height:1.5}.threat-content.visible{display:block;animation:fadeIn .3s ease}.threat-content p{margin-bottom:.5rem;opacity:.85}.threat-label{font-weight:600;color:var(--warning);font-size:.7rem;text-transform:uppercase;letter-spacing:.5px;margin-bottom:.25rem}.mitre-tags{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.5rem}.mitre-tag{background:rgba(0,119,182,.15);border:1px solid var(--info);color:var(--info);padding:.2rem .5rem;border-radius:4px;font-size:.65rem;font-family:'SF Mono',Monaco,Consolas,monospace;text-decoration:none;transition:all .2s ease}.mitre-tag:hover{background:rgba(0,119,182,.25)}@keyframes fadeIn{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}@media(max-width:768px){.grid{grid-template-columns:1fr}.data-value{max-width:55%}.header h1{font-size:2rem}.social-grid{grid-template-columns:repeat(2,1fr)}}
  </style>
  <meta name="description" content="Digital Awareness Tool - See what information websites can collect about you just by visiting.">
  <title>Digital Awareness | Peter Skaronis</title>
  <!-- Fathom - beautiful, simple website analytics -->
  <script src="https://cdn.usefathom.com/script.js" data-site="WMVSPTHG" defer></script>
  <!-- / Fathom -->
</head>
<body>
  <section>
    <nav>
      <a href="index.html" class="back-link">‚Üê Back to Home</a>
      <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle theme">üåô</button>
    </nav>

    <div class="container">
      <div class="header">
        <h1>Digital Awareness</h1>
        <p>See what information websites can collect about you just by visiting. No cookies required - this is all from your browser.</p>
      </div>

      <div class="warning-banner">
        <h3>Why does this matter?</h3>
        <p>Every website you visit can access this information. Combined, these data points create a unique "fingerprint" that can track you across the web - even without cookies.</p>
      </div>

      <div class="progress-bar">
        <div class="progress-fill" id="scanProgress" style="width: 0%"></div>
      </div>
      <p id="scanStatus" style="text-align:center;font-size:.9rem;opacity:.7">Initializing scan...</p>

      <div class="grid">
        <!-- Network Information -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üåê</span> Network</h2>
          <div class="data-row">
            <span class="data-label">Public IP</span>
            <span class="data-value" id="ip"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Location (approx)</span>
            <span class="data-value" id="location"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">ISP / Org</span>
            <span class="data-value" id="isp"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Connection Type</span>
            <span class="data-value" id="connectionType"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Downlink Speed</span>
            <span class="data-value" id="downlink"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>IP reveals physical location, ISP, and organization. Attackers use this for geotargeting, identifying corporate networks, and VPN detection.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Location-based phishing, ISP-specific exploits, network reconnaissance for targeted attacks.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1590/" target="_blank" class="mitre-tag">T1590: Gather Victim Network Info</a>
                <a href="https://attack.mitre.org/techniques/T1016/" target="_blank" class="mitre-tag">T1016: System Network Config</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Privacy Leaks - NEW -->
        <div class="card scan-animation danger-card">
          <h2><span class="card-icon">üö®</span> Privacy Leaks</h2>
          <div class="data-row">
            <span class="data-label">Local IP (WebRTC)</span>
            <span class="data-value" id="localIP"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Private Browsing</span>
            <span class="data-value" id="incognito"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Referrer</span>
            <span class="data-value" id="referrer"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Canvas Fingerprint</span>
            <span class="data-value" id="canvasHash"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Audio Fingerprint</span>
            <span class="data-value" id="audioHash"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>WebRTC leaks reveal internal network structure. Canvas/audio fingerprints create unique identifiers that persist across sessions and sites.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Cross-site tracking without cookies, identifying users even in incognito mode, internal network mapping for lateral movement.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1016/" target="_blank" class="mitre-tag">T1016: Network Config Discovery</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Browser Information -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üîç</span> Browser</h2>
          <div class="data-row">
            <span class="data-label">Browser</span>
            <span class="data-value" id="browser"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Engine</span>
            <span class="data-value" id="engine"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Language</span>
            <span class="data-value" id="language"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Cookies Enabled</span>
            <span class="data-value" id="cookies"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Do Not Track</span>
            <span class="data-value" id="dnt"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Ad Blocker</span>
            <span class="data-value" id="adblock"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Browser version reveals potential vulnerabilities. Language preferences indicate nationality/location. Ad blocker detection affects malvertising strategies.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Browser-specific exploits (CVEs), language-targeted phishing, evading ad blocker detection for malicious ads.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1189/" target="_blank" class="mitre-tag">T1189: Drive-by Compromise</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Extensions & Plugins - NEW -->
        <div class="card scan-animation warning-card">
          <h2><span class="card-icon">üß©</span> Extensions & Plugins</h2>
          <div class="data-row">
            <span class="data-label">PDF Viewer</span>
            <span class="data-value" id="pdfViewer"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Plugins Count</span>
            <span class="data-value" id="pluginsCount"><span class="loading">Detecting...</span></span>
          </div>
          <p style="font-size:.8rem;opacity:.7;margin-top:.75rem;">Detected Extensions:</p>
          <div class="extension-list" id="extensionList">
            <span class="loading">Scanning...</span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Extensions reveal security awareness (ad blockers), profession (dev tools), crypto holdings (wallets), and password management habits.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Extension-specific vulnerabilities, targeting crypto wallet users, exploiting password manager weaknesses, bypassing security extensions.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1176/" target="_blank" class="mitre-tag">T1176: Browser Extensions</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Social Logins - NEW -->
        <div class="card scan-animation danger-card">
          <h2><span class="card-icon">üë§</span> Social Login Detection</h2>
          <p style="font-size:.8rem;opacity:.7;margin-bottom:.5rem;">Sites can detect if you're logged into these services:</p>
          <div class="social-grid" id="socialGrid">
            <span class="loading">Checking...</span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Reveals active accounts and services used. Confirms identity across platforms and indicates personal/professional tools.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Targeted phishing for specific services, credential stuffing prioritization, social engineering with confirmed account knowledge.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1589/" target="_blank" class="mitre-tag">T1589: Gather Victim Identity</a>
                <a href="https://attack.mitre.org/techniques/T1566/" target="_blank" class="mitre-tag">T1566: Phishing</a>
              </div>
            </div>
          </div>
        </div>

        <!-- System Information -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üíª</span> System</h2>
          <div class="data-row">
            <span class="data-label">Operating System</span>
            <span class="data-value" id="os"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Platform</span>
            <span class="data-value" id="platform"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">CPU Cores</span>
            <span class="data-value" id="cores"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Device Memory</span>
            <span class="data-value" id="memory"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Touch Support</span>
            <span class="data-value" id="touch"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Device Type</span>
            <span class="data-value" id="deviceType"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>OS version reveals patch level and potential vulnerabilities. CPU cores and memory indicate device value and processing capabilities for cryptomining.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>OS-specific exploits, device-targeted malware, identifying high-value targets (expensive hardware), tailoring payloads to available resources.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1592/" target="_blank" class="mitre-tag">T1592: Gather Victim Host Info</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Display Information -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üñ•Ô∏è</span> Display</h2>
          <div class="data-row">
            <span class="data-label">Screen Resolution</span>
            <span class="data-value" id="screenRes"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Available Screen</span>
            <span class="data-value" id="availScreen"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Viewport Size</span>
            <span class="data-value" id="viewport"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Color Depth</span>
            <span class="data-value" id="colorDepth"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Pixel Ratio</span>
            <span class="data-value" id="pixelRatio"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">HDR Support</span>
            <span class="data-value" id="hdr"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Screen resolution and available screen area reveal monitor setup, taskbar position, and potential multi-monitor configuration. Unique combinations aid fingerprinting.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Crafting phishing pages that match victim's resolution, detecting virtual machines (unusual resolutions), identifying dual-monitor setups for targeted attacks.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1497/" target="_blank" class="mitre-tag">T1497: Virtualization/Sandbox Evasion</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Graphics Information -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üéÆ</span> Graphics</h2>
          <div class="data-row">
            <span class="data-label">GPU Vendor</span>
            <span class="data-value" id="gpuVendor"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">GPU Renderer</span>
            <span class="data-value" id="gpuRenderer"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">WebGL Version</span>
            <span class="data-value" id="webgl"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Max Texture Size</span>
            <span class="data-value" id="maxTexture"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>GPU details are highly unique identifiers. Specific GPU models indicate device age, value, and gaming/professional use. Virtual machine GPUs have distinctive signatures.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>VM/sandbox detection to evade security researchers, GPU-specific exploits, identifying valuable targets (workstations with professional GPUs), cryptojacking capability assessment.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1497/" target="_blank" class="mitre-tag">T1497: Virtualization/Sandbox Evasion</a>
                <a href="https://attack.mitre.org/techniques/T1496/" target="_blank" class="mitre-tag">T1496: Resource Hijacking</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Fonts - NEW -->
        <div class="card scan-animation warning-card">
          <h2><span class="card-icon">üî§</span> Font Fingerprinting</h2>
          <div class="data-row">
            <span class="data-label">Detected Fonts</span>
            <span class="data-value" id="fontCount"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Font Hash</span>
            <span class="data-value" id="fontHash"><span class="loading">Detecting...</span></span>
          </div>
          <p style="font-size:.75rem;opacity:.7;margin-top:.5rem;">Sample of detected fonts:</p>
          <div class="font-list" id="fontList">
            <span class="loading">Enumerating fonts...</span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Installed fonts are extremely unique. Professional software (Adobe, Microsoft Office) installs distinctive fonts. Developer fonts reveal coding activity. Language fonts indicate nationality.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Highly reliable cross-session tracking, identifying professionals by software fonts, detecting security researchers by dev tool fonts, persistent identification despite cookie clearing.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Time & Location -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üïê</span> Time & Locale</h2>
          <div class="data-row">
            <span class="data-label">Timezone</span>
            <span class="data-value" id="timezone"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">UTC Offset</span>
            <span class="data-value" id="utcOffset"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Local Time</span>
            <span class="data-value" id="localTime"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Date Format</span>
            <span class="data-value" id="dateFormat"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Timezone confirms physical location even with VPN. Date/time format reveals cultural background. Unusual timezones may indicate travelers or expats.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Timing attacks based on victim's active hours, VPN detection (timezone mismatch with IP), scheduling phishing for optimal response times, regional attack campaigns.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1124/" target="_blank" class="mitre-tag">T1124: System Time Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1614/" target="_blank" class="mitre-tag">T1614: System Location Discovery</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Battery & Power -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üîã</span> Battery</h2>
          <div class="data-row">
            <span class="data-label">Battery Level</span>
            <span class="data-value" id="batteryLevel"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Charging Status</span>
            <span class="data-value" id="charging"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Time to Full</span>
            <span class="data-value" id="chargingTime"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Time to Empty</span>
            <span class="data-value" id="dischargingTime"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Battery status reveals mobile vs. desktop use. Charging patterns indicate user behavior. Low battery users may make hasty security decisions.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Urgency-based phishing when battery is low, device type confirmation, tracking via battery level changes over time, identifying mobile targets for SMS phishing.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                <a href="https://attack.mitre.org/techniques/T1422/" target="_blank" class="mitre-tag">T1422: System Network Config (Mobile)</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Storage & Features -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üíæ</span> Storage & Features</h2>
          <div class="data-row">
            <span class="data-label">Local Storage</span>
            <span class="data-value" id="localStorage"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Session Storage</span>
            <span class="data-value" id="sessionStorage"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">IndexedDB</span>
            <span class="data-value" id="indexedDB"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Web Workers</span>
            <span class="data-value" id="webWorkers"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Service Workers</span>
            <span class="data-value" id="serviceWorkers"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Storage capabilities indicate browser features and potential for persistent tracking. Service Worker support enables background execution.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Persistent malware via Service Workers, evercookies using multiple storage mechanisms, offline attack payloads, background cryptocurrency mining.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1185/" target="_blank" class="mitre-tag">T1185: Browser Session Hijacking</a>
                <a href="https://attack.mitre.org/techniques/T1059/" target="_blank" class="mitre-tag">T1059.007: JavaScript Execution</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Storage Inspector - NEW -->
        <div class="card scan-animation danger-card">
          <h2><span class="card-icon">üóÉÔ∏è</span> Storage Inspector</h2>
          <p style="font-size:.8rem;opacity:.7;margin-bottom:.5rem;">Any website can read all data stored in your browser for their domain:</p>
          <div class="data-row">
            <span class="data-label">Total Items</span>
            <span class="data-value" id="storageCount"><span class="loading">Scanning...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Sensitive Items</span>
            <span class="data-value" id="sensitiveCount"><span class="loading">Scanning...</span></span>
          </div>
          <div class="storage-inspector" id="storageInspector">
            <div class="storage-section">
              <h4>LocalStorage <span class="count" id="localStorageCount">0</span></h4>
              <div class="storage-list" id="localStorageList">
                <div class="storage-empty">Scanning...</div>
              </div>
            </div>
            <div class="storage-section">
              <h4>SessionStorage <span class="count" id="sessionStorageCount">0</span></h4>
              <div class="storage-list" id="sessionStorageList">
                <div class="storage-empty">Scanning...</div>
              </div>
            </div>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Stored data often contains authentication tokens, user preferences, tracking IDs, and cached personal information. XSS attacks can exfiltrate all stored data.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>XSS payload stealing tokens/sessions, persistent tracking via stored identifiers, account takeover via stolen auth tokens, privacy profiling from preferences.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1185/" target="_blank" class="mitre-tag">T1185: Browser Session Hijacking</a>
                <a href="https://attack.mitre.org/techniques/T1539/" target="_blank" class="mitre-tag">T1539: Steal Web Session Cookie</a>
                <a href="https://attack.mitre.org/techniques/T1005/" target="_blank" class="mitre-tag">T1005: Data from Local System</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Media Capabilities -->
        <div class="card scan-animation">
          <h2><span class="card-icon">üéµ</span> Media</h2>
          <div class="data-row">
            <span class="data-label">Audio Formats</span>
            <span class="data-value" id="audioFormats"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Video Formats</span>
            <span class="data-value" id="videoFormats"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">WebRTC Support</span>
            <span class="data-value" id="webrtc"><span class="loading">Detecting...</span></span>
          </div>
          <div class="data-row">
            <span class="data-label">Media Devices</span>
            <span class="data-value" id="mediaDevices"><span class="loading">Detecting...</span></span>
          </div>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Media capabilities indicate device type and codec support. WebRTC reveals camera/microphone presence. Media device IDs can be persistent identifiers.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Identifying targets with cameras for sextortion, codec-based fingerprinting, WebRTC IP leaks, unauthorized media access attempts via permission prompts.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1125/" target="_blank" class="mitre-tag">T1125: Video Capture</a>
                <a href="https://attack.mitre.org/techniques/T1123/" target="_blank" class="mitre-tag">T1123: Audio Capture</a>
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Fingerprint -->
        <div class="card scan-animation" style="grid-column: 1 / -1;">
          <h2><span class="card-icon">üîê</span> Your Browser Fingerprint</h2>
          <p style="margin-bottom:1rem;opacity:.8;font-size:.9rem;">This hash is generated from your browser characteristics. It's likely unique to you among millions of users.</p>
          <div class="fingerprint-display" id="fingerprint">
            <span class="loading">Calculating fingerprint...</span>
          </div>
          <p style="margin-top:1rem;font-size:.85rem;opacity:.7;">Uniqueness estimate: <strong id="uniqueness">Calculating...</strong></p>
          <div class="threat-intel">
            <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
            <div class="threat-content">
              <div class="threat-label">OSINT Value</div>
              <p>Browser fingerprinting combines all collected data into a unique identifier that persists across sessions, VPNs, and cookie clearing. Used for tracking and de-anonymization.</p>
              <div class="threat-label">Attack Vectors</div>
              <p>Persistent cross-site tracking, identifying users despite privacy measures, linking anonymous accounts to real identities, fraud detection evasion research.</p>
              <div class="mitre-tags">
                <a href="https://attack.mitre.org/techniques/T1592/" target="_blank" class="mitre-tag">T1592: Gather Victim Host Info</a>
                <a href="https://attack.mitre.org/techniques/T1589/" target="_blank" class="mitre-tag">T1589: Gather Victim Identity</a>
                <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div style="text-align:center">
        <button class="refresh-btn" onclick="location.reload()">Scan Again</button>
      </div>

      <div class="footer">
        <p>This tool is for educational purposes only. No data is stored or transmitted.</p>
        <p style="margin-top:.5rem"><a href="index.html">‚Üê Back to Home</a></p>
      </div>
    </div>
  </section>

<script>
(function () {
  // Theme toggle
  var root = document.documentElement;
  var btn = document.getElementById('themeToggle');
  var KEY = 'theme';
  function current() { return root.dataset.theme || 'light'; }
  function setTheme(t) {
    root.dataset.theme = t;
    try { localStorage.setItem(KEY, t); } catch(e) {}
    if (btn) btn.textContent = (t === 'dark') ? '‚òÄÔ∏è' : 'üåô';
  }
  setTheme(current());
  if (btn) btn.addEventListener('click', function(){ setTheme(current() === 'dark' ? 'light' : 'dark'); });
})();

// Main detection script
(function() {
  const $ = id => document.getElementById(id);
  const progress = $('scanProgress');
  const status = $('scanStatus');
  let progressValue = 0;

  function updateProgress(value, message) {
    progressValue = value;
    progress.style.width = value + '%';
    status.textContent = message;
  }

  function setValue(id, value, className) {
    const el = $(id);
    if (el) {
      el.textContent = value || 'Not available';
      if (className) el.className = 'data-value ' + className;
    }
  }

  function setStatus(id, isEnabled) {
    const el = $(id);
    if (el) {
      el.innerHTML = `<span class="status-indicator ${isEnabled ? 'status-yes' : 'status-no'}"></span>${isEnabled ? 'Yes' : 'No'}`;
    }
  }

  // Simple hash function
  function simpleHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash = hash & hash;
    }
    return Math.abs(hash).toString(16).padStart(8, '0');
  }

  // Detect browser
  function detectBrowser() {
    const ua = navigator.userAgent;
    let browser = 'Unknown';
    let version = '';

    if (ua.includes('Firefox/')) {
      browser = 'Firefox';
      version = ua.match(/Firefox\/(\d+)/)?.[1] || '';
    } else if (ua.includes('Edg/')) {
      browser = 'Edge';
      version = ua.match(/Edg\/(\d+)/)?.[1] || '';
    } else if (ua.includes('Chrome/')) {
      browser = 'Chrome';
      version = ua.match(/Chrome\/(\d+)/)?.[1] || '';
    } else if (ua.includes('Safari/') && !ua.includes('Chrome')) {
      browser = 'Safari';
      version = ua.match(/Version\/(\d+)/)?.[1] || '';
    } else if (ua.includes('Opera') || ua.includes('OPR/')) {
      browser = 'Opera';
      version = ua.match(/(?:Opera|OPR)\/(\d+)/)?.[1] || '';
    }

    return browser + (version ? ' ' + version : '');
  }

  // Detect OS
  function detectOS() {
    const ua = navigator.userAgent;
    const platform = navigator.platform;

    if (ua.includes('Windows NT 10')) return 'Windows 10/11';
    if (ua.includes('Windows NT 6.3')) return 'Windows 8.1';
    if (ua.includes('Windows NT 6.2')) return 'Windows 8';
    if (ua.includes('Windows NT 6.1')) return 'Windows 7';
    if (ua.includes('Mac OS X')) {
      const match = ua.match(/Mac OS X (\d+[._]\d+)/);
      return 'macOS ' + (match ? match[1].replace('_', '.') : '');
    }
    if (ua.includes('Android')) {
      const match = ua.match(/Android (\d+(\.\d+)?)/);
      return 'Android ' + (match ? match[1] : '');
    }
    if (ua.includes('iPhone') || ua.includes('iPad')) {
      const match = ua.match(/OS (\d+_\d+)/);
      return 'iOS ' + (match ? match[1].replace('_', '.') : '');
    }
    if (ua.includes('Linux')) return 'Linux';
    if (ua.includes('CrOS')) return 'Chrome OS';

    return platform || 'Unknown';
  }

  // Detect engine
  function detectEngine() {
    const ua = navigator.userAgent;
    if (ua.includes('Gecko/')) return 'Gecko (Firefox)';
    if (ua.includes('AppleWebKit/')) {
      if (ua.includes('Chrome/')) return 'Blink (Chromium)';
      return 'WebKit (Safari)';
    }
    return 'Unknown';
  }

  // Detect device type
  function detectDeviceType() {
    const ua = navigator.userAgent;
    if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) return 'Tablet';
    if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) return 'Mobile';
    return 'Desktop';
  }

  // Get WebGL info
  function getWebGLInfo() {
    try {
      const canvas = document.createElement('canvas');
      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      if (!gl) return { vendor: 'Not supported', renderer: 'Not supported', version: 'Not supported', maxTexture: 'N/A' };

      const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
      return {
        vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : gl.getParameter(gl.VENDOR),
        renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : gl.getParameter(gl.RENDERER),
        version: gl.getParameter(gl.VERSION),
        maxTexture: gl.getParameter(gl.MAX_TEXTURE_SIZE) + 'px'
      };
    } catch(e) {
      return { vendor: 'Error', renderer: 'Error', version: 'Error', maxTexture: 'Error' };
    }
  }

  // WebRTC Local IP Detection
  async function getLocalIPs() {
    const ips = new Set();
    try {
      const pc = new RTCPeerConnection({ iceServers: [] });
      pc.createDataChannel('');
      const offer = await pc.createOffer();
      await pc.setLocalDescription(offer);

      return new Promise((resolve) => {
        const timeout = setTimeout(() => {
          pc.close();
          resolve(Array.from(ips));
        }, 2000);

        pc.onicecandidate = (e) => {
          if (!e.candidate) {
            clearTimeout(timeout);
            pc.close();
            resolve(Array.from(ips));
            return;
          }
          const match = e.candidate.candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
          if (match) {
            const ip = match[1];
            if (!ip.startsWith('0.')) ips.add(ip);
          }
        };
      });
    } catch(e) {
      return [];
    }
  }

  // Incognito/Private mode detection
  async function detectIncognito() {
    // Try multiple detection methods

    // Method 1: Storage quota (Chrome)
    if ('storage' in navigator && 'estimate' in navigator.storage) {
      try {
        const { quota } = await navigator.storage.estimate();
        if (quota && quota < 120000000) return true; // Less than ~120MB suggests incognito
      } catch(e) {}
    }

    // Method 2: IndexedDB behavior (Firefox)
    try {
      const db = indexedDB.open('test');
      db.onerror = () => true;
    } catch(e) {
      return true;
    }

    // Method 3: FileSystem API (older Chrome)
    if ('webkitRequestFileSystem' in window) {
      return new Promise(resolve => {
        window.webkitRequestFileSystem(
          window.TEMPORARY, 100,
          () => resolve(false),
          () => resolve(true)
        );
      });
    }

    return false;
  }

  // Canvas fingerprint
  function getCanvasFingerprint() {
    try {
      const canvas = document.createElement('canvas');
      canvas.width = 200;
      canvas.height = 50;
      const ctx = canvas.getContext('2d');

      ctx.textBaseline = 'top';
      ctx.font = '14px Arial';
      ctx.fillStyle = '#f60';
      ctx.fillRect(125, 1, 62, 20);
      ctx.fillStyle = '#069';
      ctx.fillText('Cwm fjord', 2, 15);
      ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
      ctx.fillText('Cwm fjord', 4, 17);

      return simpleHash(canvas.toDataURL()).toUpperCase();
    } catch(e) {
      return 'Not available';
    }
  }

  // Audio fingerprint
  function getAudioFingerprint() {
    try {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const analyser = audioContext.createAnalyser();
      const gain = audioContext.createGain();
      const processor = audioContext.createScriptProcessor(4096, 1, 1);

      gain.gain.value = 0;
      oscillator.type = 'triangle';
      oscillator.connect(analyser);
      analyser.connect(processor);
      processor.connect(gain);
      gain.connect(audioContext.destination);
      oscillator.start(0);

      const bins = new Float32Array(analyser.frequencyBinCount);
      analyser.getFloatFrequencyData(bins);

      oscillator.stop();
      audioContext.close();

      return simpleHash(bins.slice(0, 30).join(',')).toUpperCase();
    } catch(e) {
      return 'Not available';
    }
  }

  // Font detection
  function detectFonts() {
    const baseFonts = ['monospace', 'sans-serif', 'serif'];
    const testFonts = [
      'Arial', 'Arial Black', 'Arial Narrow', 'Calibri', 'Cambria', 'Century Gothic',
      'Comic Sans MS', 'Consolas', 'Courier', 'Courier New', 'Georgia', 'Helvetica',
      'Impact', 'Lucida Console', 'Lucida Sans', 'Monaco', 'Palatino', 'Segoe UI',
      'Tahoma', 'Times', 'Times New Roman', 'Trebuchet MS', 'Verdana',
      'Roboto', 'Open Sans', 'Lato', 'Source Sans Pro', 'Ubuntu', 'Noto Sans',
      'Fira Code', 'JetBrains Mono', 'SF Pro', 'SF Mono', 'Menlo', 'Cascadia Code',
      'Wingdings', 'Webdings', 'Symbol', 'Apple Symbols', 'Zapf Dingbats'
    ];

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const testString = 'mmmmmmmmmmlli';
    const testSize = '72px';

    const baseWidths = {};
    baseFonts.forEach(font => {
      ctx.font = `${testSize} ${font}`;
      baseWidths[font] = ctx.measureText(testString).width;
    });

    const detected = [];
    testFonts.forEach(font => {
      for (const baseFont of baseFonts) {
        ctx.font = `${testSize} "${font}", ${baseFont}`;
        const width = ctx.measureText(testString).width;
        if (width !== baseWidths[baseFont]) {
          detected.push(font);
          break;
        }
      }
    });

    return detected;
  }

  // Extension detection - uses multiple reliable methods
  async function detectExtensions() {
    const detected = [];

    // 1. Global object detection - extensions inject these into window
    const globalChecks = [
      { check: () => window.__REACT_DEVTOOLS_GLOBAL_HOOK__, name: 'React DevTools' },
      { check: () => window.__VUE_DEVTOOLS_GLOBAL_HOOK__, name: 'Vue DevTools' },
      { check: () => window.__REDUX_DEVTOOLS_EXTENSION__, name: 'Redux DevTools' },
      { check: () => window.ethereum, name: 'Web3 Wallet (MetaMask/etc)' },
      { check: () => window.solana, name: 'Solana Wallet (Phantom/etc)' },
      { check: () => window.kardiachain, name: 'KardiaChain Wallet' },
      { check: () => window.web3, name: 'Web3 Provider' },
      { check: () => window.Grammarly, name: 'Grammarly' },
      { check: () => window.__GRAMMARLY_EXTENSION_INSTALL_URL__, name: 'Grammarly' },
      { check: () => window.safari?.pushNotification, name: 'Safari Extensions' },
      { check: () => window.__widevine_cdm_path__, name: 'Widevine CDM' },
      { check: () => window.chrome?.csi, name: 'Chrome Internal' },
    ];

    for (const { check, name } of globalChecks) {
      try { if (check()) detected.push(name); } catch(e) {}
    }

    // 2. DOM element detection - extensions inject elements
    const domChecks = [
      { selector: 'grammarly-desktop-integration', name: 'Grammarly' },
      { selector: 'grammarly-extension', name: 'Grammarly' },
      { selector: '[data-grammarly-shadow-root]', name: 'Grammarly' },
      { selector: '#lastpass-icon', name: 'LastPass' },
      { selector: '[data-lastpass-icon]', name: 'LastPass' },
      { selector: '[data-lastpass-root]', name: 'LastPass' },
      { selector: '.bitwarden-icon', name: 'Bitwarden' },
      { selector: '[data-bitwarden]', name: 'Bitwarden' },
      { selector: '#onepassword-icon', name: '1Password' },
      { selector: '[data-1p-ignore]', name: '1Password' },
      { selector: '[data-dashlanecreated]', name: 'Dashlane' },
      { selector: '.dashlane-icon', name: 'Dashlane' },
      { selector: '#honey-button', name: 'Honey (PayPal)' },
      { selector: '[data-honey-container]', name: 'Honey (PayPal)' },
      { selector: '.honey-gold-button', name: 'Honey (PayPal)' },
      { selector: '#NordVPNPopup', name: 'NordVPN' },
      { selector: '[data-surfshark]', name: 'Surfshark VPN' },
      { selector: '.ep_font', name: 'ExpressVPN' },
      { selector: '#av_icon', name: 'Avast' },
      { selector: '[data-mcafee]', name: 'McAfee WebAdvisor' },
      { selector: '#pocket-extension-root', name: 'Pocket' },
      { selector: '[data-evernote-clipper]', name: 'Evernote Web Clipper' },
      { selector: '#roboform-toolbar', name: 'RoboForm' },
      { selector: '[data-keeper-lock]', name: 'Keeper' },
      { selector: '.zoho-vault-icon', name: 'Zoho Vault' },
    ];

    for (const { selector, name } of domChecks) {
      try { if (document.querySelector(selector)) detected.push(name); } catch(e) {}
    }

    // 3. Ad blocker detection via bait elements
    const adBlockerDetected = await (async () => {
      const baitClasses = [
        'ad', 'ads', 'adsbox', 'ad-banner', 'ad-wrapper', 'ad-container',
        'doubleclick', 'google-ad', 'sponsored-ad', 'advertisement'
      ];
      const bait = document.createElement('div');
      bait.innerHTML = '&nbsp;';
      bait.className = baitClasses.join(' ');
      bait.style.cssText = 'position:absolute;left:-9999px;width:1px;height:1px;';
      document.body.appendChild(bait);
      await new Promise(r => setTimeout(r, 100));
      const blocked = bait.offsetHeight === 0 || bait.offsetWidth === 0 ||
                      getComputedStyle(bait).display === 'none' ||
                      getComputedStyle(bait).visibility === 'hidden';
      document.body.removeChild(bait);
      return blocked;
    })();
    if (adBlockerDetected) detected.push('Ad Blocker (Generic)');

    // 4. Script blocker detection
    const scriptBlockerDetected = await (async () => {
      try {
        const testScript = document.createElement('script');
        testScript.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
        testScript.async = true;
        let blocked = false;
        testScript.onerror = () => { blocked = true; };
        document.head.appendChild(testScript);
        await new Promise(r => setTimeout(r, 200));
        document.head.removeChild(testScript);
        return blocked;
      } catch(e) { return true; }
    })();
    if (scriptBlockerDetected && !adBlockerDetected) detected.push('Script Blocker');

    // 5. Check for CSS injected by extensions
    const cssChecks = () => {
      const styles = Array.from(document.styleSheets);
      for (const sheet of styles) {
        try {
          const href = sheet.href || '';
          if (href.includes('chrome-extension://')) detected.push('Chrome Extension (CSS)');
          if (href.includes('moz-extension://')) detected.push('Firefox Extension (CSS)');
          if (href.includes('safari-extension://')) detected.push('Safari Extension (CSS)');
        } catch(e) {}
      }
    };
    cssChecks();

    // 6. Check navigator.plugins for clues
    if (navigator.plugins) {
      const pluginNames = Array.from(navigator.plugins).map(p => p.name.toLowerCase());
      if (pluginNames.some(n => n.includes('chromium pdf'))) detected.push('Chromium PDF Viewer');
      if (pluginNames.some(n => n.includes('widevine'))) detected.push('Widevine DRM');
    }

    // 7. Detect color scheme preference override (Dark Reader, etc.)
    const darkModeCheck = () => {
      const testEl = document.createElement('div');
      testEl.style.cssText = 'position:absolute;left:-9999px;background:white;';
      document.body.appendChild(testEl);
      const bg = getComputedStyle(testEl).backgroundColor;
      document.body.removeChild(testEl);
      // If background isn't white, an extension might be overriding it
      if (bg !== 'rgb(255, 255, 255)' && bg !== 'rgba(0, 0, 0, 0)') {
        detected.push('Dark Mode Extension (likely)');
      }
    };
    try { darkModeCheck(); } catch(e) {}

    // Return unique values
    return [...new Set(detected)];
  }

  // Social login detection (timing-based image loading)
  async function detectSocialLogins() {
    const services = [
      { name: 'Google', icon: 'üîç', url: 'https://accounts.google.com/CheckCookie?continue=https://www.google.com/intl/en/images/logos/accounts_logo.png' },
      { name: 'Facebook', icon: 'üìò', url: 'https://www.facebook.com/login/device-based/regular/login/' },
      { name: 'Twitter/X', icon: 'üê¶', url: 'https://twitter.com/login' },
      { name: 'LinkedIn', icon: 'üíº', url: 'https://www.linkedin.com/uas/login' },
      { name: 'GitHub', icon: 'üêô', url: 'https://github.com/login' },
      { name: 'Amazon', icon: 'üì¶', url: 'https://www.amazon.com/ap/signin' },
      { name: 'Microsoft', icon: 'ü™ü', url: 'https://login.live.com/' },
      { name: 'Apple', icon: 'üçé', url: 'https://appleid.apple.com/auth/authorize' }
    ];

    // Note: Modern browsers have largely blocked these timing attacks
    // This is for educational demonstration
    return services.map(s => ({ ...s, detected: 'Unknown' }));
  }

  // Check audio formats
  function checkAudioFormats() {
    const audio = document.createElement('audio');
    const formats = [];
    if (audio.canPlayType('audio/mpeg')) formats.push('MP3');
    if (audio.canPlayType('audio/ogg')) formats.push('OGG');
    if (audio.canPlayType('audio/wav')) formats.push('WAV');
    if (audio.canPlayType('audio/aac')) formats.push('AAC');
    if (audio.canPlayType('audio/webm')) formats.push('WebM');
    return formats.join(', ') || 'None detected';
  }

  // Check video formats
  function checkVideoFormats() {
    const video = document.createElement('video');
    const formats = [];
    if (video.canPlayType('video/mp4')) formats.push('MP4');
    if (video.canPlayType('video/webm')) formats.push('WebM');
    if (video.canPlayType('video/ogg')) formats.push('OGG');
    if (video.canPlayType('application/x-mpegURL')) formats.push('HLS');
    return formats.join(', ') || 'None detected';
  }

  // Detect ad blocker
  async function detectAdBlocker() {
    try {
      const testAd = document.createElement('div');
      testAd.innerHTML = '&nbsp;';
      testAd.className = 'adsbox ad-banner ad-wrapper';
      testAd.style.cssText = 'position:absolute;left:-9999px;';
      document.body.appendChild(testAd);
      await new Promise(r => setTimeout(r, 100));
      const blocked = testAd.offsetHeight === 0;
      document.body.removeChild(testAd);
      return blocked;
    } catch(e) {
      return false;
    }
  }

  // Storage inspector
  function inspectStorage() {
    const sensitivePatterns = [
      /token/i, /auth/i, /session/i, /password/i, /passwd/i, /secret/i,
      /key/i, /api[_-]?key/i, /credential/i, /jwt/i, /bearer/i,
      /email/i, /user/i, /login/i, /account/i, /private/i,
      /credit/i, /card/i, /cvv/i, /ssn/i, /social/i,
      /phone/i, /address/i, /location/i, /cookie/i
    ];

    function isSensitive(key, value) {
      const combined = (key + ' ' + value).toLowerCase();
      return sensitivePatterns.some(pattern => pattern.test(combined));
    }

    function truncateValue(value, maxLen = 100) {
      if (value.length > maxLen) {
        return value.substring(0, maxLen) + '...';
      }
      return value;
    }

    function renderStorageItems(storage, listEl, countEl) {
      const items = [];
      let sensitiveCount = 0;

      try {
        for (let i = 0; i < storage.length; i++) {
          const key = storage.key(i);
          const value = storage.getItem(key);
          const sensitive = isSensitive(key, value);
          if (sensitive) sensitiveCount++;
          items.push({ key, value, sensitive });
        }
      } catch(e) {
        listEl.innerHTML = '<div class="storage-empty">Unable to read storage</div>';
        countEl.textContent = '0';
        return { total: 0, sensitive: 0 };
      }

      countEl.textContent = items.length;

      if (items.length === 0) {
        listEl.innerHTML = '<div class="storage-empty">Empty - no data stored</div>';
      } else {
        listEl.innerHTML = items.map(item => `
          <div class="storage-item ${item.sensitive ? 'sensitive' : ''}">
            <div class="storage-key">${escapeHtml(item.key)}${item.sensitive ? '<span class="sensitive-badge">Sensitive</span>' : ''}</div>
            <div class="storage-value">${escapeHtml(truncateValue(item.value))}</div>
          </div>
        `).join('');
      }

      return { total: items.length, sensitive: sensitiveCount };
    }

    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // Render localStorage
    const localResult = renderStorageItems(
      localStorage,
      $('localStorageList'),
      $('localStorageCount')
    );

    // Render sessionStorage
    const sessionResult = renderStorageItems(
      sessionStorage,
      $('sessionStorageList'),
      $('sessionStorageCount')
    );

    // Update totals
    const totalItems = localResult.total + sessionResult.total;
    const totalSensitive = localResult.sensitive + sessionResult.sensitive;

    setValue('storageCount', totalItems + ' items');
    if (totalSensitive > 0) {
      setValue('sensitiveCount', totalSensitive + ' found!', 'danger');
    } else {
      setValue('sensitiveCount', 'None detected');
    }

    return { totalItems, totalSensitive };
  }

  // Generate fingerprint
  function generateFingerprint(data) {
    const fingerprintData = JSON.stringify(data);
    const hash1 = simpleHash(fingerprintData);
    const hash2 = simpleHash(fingerprintData.split('').reverse().join(''));
    const hash3 = simpleHash(hash1 + hash2);
    const hash4 = simpleHash(fingerprintData + Date.now().toString().slice(0, -6));
    return `${hash1}-${hash2}-${hash3}-${hash4}`.toUpperCase();
  }

  // Main scan function
  async function runScan() {
    updateProgress(5, 'Detecting browser information...');

    // Browser info
    setValue('browser', detectBrowser());
    setValue('engine', detectEngine());
    setValue('language', navigator.languages ? navigator.languages.join(', ') : navigator.language);
    setStatus('cookies', navigator.cookieEnabled);
    setValue('dnt', navigator.doNotTrack === '1' ? 'Enabled' : 'Disabled');

    updateProgress(10, 'Detecting privacy leaks...');

    // Privacy leaks
    const localIPs = await getLocalIPs();
    if (localIPs.length > 0) {
      setValue('localIP', localIPs.join(', '), 'danger');
    } else {
      setValue('localIP', 'Protected / Not detected');
    }

    const isIncognito = await detectIncognito();
    setValue('incognito', isIncognito ? 'Yes - Detected!' : 'No', isIncognito ? 'danger' : '');

    setValue('referrer', document.referrer || 'Direct visit (no referrer)');
    setValue('canvasHash', getCanvasFingerprint(), 'warning');
    setValue('audioHash', getAudioFingerprint(), 'warning');

    updateProgress(20, 'Detecting system information...');

    // System info
    setValue('os', detectOS());
    setValue('platform', navigator.platform);
    setValue('cores', navigator.hardwareConcurrency || 'Not available');
    setValue('memory', navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'Not available');
    setValue('touch', ('ontouchstart' in window || navigator.maxTouchPoints > 0) ? 'Yes (' + navigator.maxTouchPoints + ' points)' : 'No');
    setValue('deviceType', detectDeviceType());

    updateProgress(30, 'Detecting display properties...');

    // Display info
    setValue('screenRes', screen.width + ' x ' + screen.height);
    setValue('availScreen', screen.availWidth + ' x ' + screen.availHeight);
    setValue('viewport', window.innerWidth + ' x ' + window.innerHeight);
    setValue('colorDepth', screen.colorDepth + '-bit');
    setValue('pixelRatio', window.devicePixelRatio + 'x');
    setValue('hdr', window.matchMedia('(dynamic-range: high)').matches ? 'Supported' : 'Not detected');

    updateProgress(40, 'Detecting graphics capabilities...');

    // Graphics info
    const webgl = getWebGLInfo();
    setValue('gpuVendor', webgl.vendor);
    setValue('gpuRenderer', webgl.renderer);
    setValue('webgl', webgl.version);
    setValue('maxTexture', webgl.maxTexture);

    updateProgress(50, 'Enumerating fonts...');

    // Font detection
    const fonts = detectFonts();
    setValue('fontCount', fonts.length + ' fonts detected', 'warning');
    setValue('fontHash', simpleHash(fonts.join(',')).toUpperCase(), 'warning');
    $('fontList').textContent = fonts.slice(0, 20).join(', ') + (fonts.length > 20 ? '...' : '');

    updateProgress(60, 'Detecting extensions...');

    // Extensions
    setValue('pdfViewer', navigator.pdfViewerEnabled ? 'Built-in' : 'External/None');
    setValue('pluginsCount', navigator.plugins ? navigator.plugins.length + ' plugins' : 'Not available');

    const extensions = await detectExtensions();
    const extList = $('extensionList');
    if (extensions.length > 0) {
      extList.innerHTML = extensions.map(ext => {
        const isPrivacyTool = ['uBlock Origin', 'AdBlock', 'AdBlock Plus', 'Ghostery', 'Privacy Badger'].includes(ext);
        return `<span class="extension-tag ${isPrivacyTool ? 'privacy-risk' : 'detected'}">${ext}</span>`;
      }).join('');
    } else {
      extList.innerHTML = '<span style="opacity:.7;font-size:.8rem;">None detected (extensions may be hidden)</span>';
    }

    updateProgress(65, 'Checking social logins...');

    // Social logins
    const socialLogins = await detectSocialLogins();
    const socialGrid = $('socialGrid');
    socialGrid.innerHTML = socialLogins.map(s =>
      `<div class="social-item"><span class="social-icon">${s.icon}</span>${s.name}</div>`
    ).join('');

    updateProgress(70, 'Detecting time and locale...');

    // Time info
    setValue('timezone', Intl.DateTimeFormat().resolvedOptions().timeZone);
    const offset = new Date().getTimezoneOffset();
    setValue('utcOffset', 'UTC' + (offset <= 0 ? '+' : '-') + Math.abs(offset / 60));
    setValue('localTime', new Date().toLocaleTimeString());
    setValue('dateFormat', new Date().toLocaleDateString());

    updateProgress(75, 'Checking storage capabilities...');

    // Storage info
    setStatus('localStorage', !!window.localStorage);
    setStatus('sessionStorage', !!window.sessionStorage);
    setStatus('indexedDB', !!window.indexedDB);
    setStatus('webWorkers', !!window.Worker);
    setStatus('serviceWorkers', 'serviceWorker' in navigator);

    updateProgress(77, 'Inspecting storage contents...');

    // Inspect storage contents
    inspectStorage();

    updateProgress(80, 'Detecting media capabilities...');

    // Media info
    setValue('audioFormats', checkAudioFormats());
    setValue('videoFormats', checkVideoFormats());
    setStatus('webrtc', !!window.RTCPeerConnection);
    setValue('mediaDevices', navigator.mediaDevices ? 'Available' : 'Not available');

    updateProgress(82, 'Checking for ad blocker...');

    // Ad blocker detection
    const hasAdBlocker = await detectAdBlocker();
    setValue('adblock', hasAdBlocker ? 'Detected' : 'Not detected');

    updateProgress(85, 'Detecting battery status...');

    // Battery info
    if ('getBattery' in navigator) {
      try {
        const battery = await navigator.getBattery();
        setValue('batteryLevel', Math.round(battery.level * 100) + '%');
        setValue('charging', battery.charging ? 'Yes' : 'No');
        setValue('chargingTime', battery.chargingTime === Infinity ? 'N/A' : Math.round(battery.chargingTime / 60) + ' min');
        setValue('dischargingTime', battery.dischargingTime === Infinity ? 'N/A' : Math.round(battery.dischargingTime / 60) + ' min');
      } catch(e) {
        setValue('batteryLevel', 'Not available');
        setValue('charging', 'Not available');
        setValue('chargingTime', 'Not available');
        setValue('dischargingTime', 'Not available');
      }
    } else {
      setValue('batteryLevel', 'API not supported');
      setValue('charging', 'API not supported');
      setValue('chargingTime', 'API not supported');
      setValue('dischargingTime', 'API not supported');
    }

    updateProgress(90, 'Fetching network information...');

    // Network info
    if ('connection' in navigator) {
      const conn = navigator.connection;
      setValue('connectionType', conn.effectiveType ? conn.effectiveType.toUpperCase() : 'Unknown');
      setValue('downlink', conn.downlink ? conn.downlink + ' Mbps' : 'Unknown');
    } else {
      setValue('connectionType', 'API not supported');
      setValue('downlink', 'API not supported');
    }

    // Fetch public IP
    try {
      const response = await fetch('https://ipapi.co/json/');
      const data = await response.json();
      setValue('ip', data.ip);
      setValue('location', `${data.city}, ${data.region}, ${data.country_name}`);
      setValue('isp', data.org);
    } catch(e) {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        setValue('ip', data.ip);
        setValue('location', 'Could not determine');
        setValue('isp', 'Could not determine');
      } catch(e2) {
        setValue('ip', 'Could not fetch');
        setValue('location', 'Could not fetch');
        setValue('isp', 'Could not fetch');
      }
    }

    updateProgress(95, 'Generating fingerprint...');

    // Generate fingerprint
    const fingerprintData = {
      browser: detectBrowser(),
      os: detectOS(),
      screen: `${screen.width}x${screen.height}x${screen.colorDepth}`,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      language: navigator.language,
      cores: navigator.hardwareConcurrency,
      memory: navigator.deviceMemory,
      touch: navigator.maxTouchPoints,
      gpu: webgl.renderer,
      platform: navigator.platform,
      fonts: fonts.length,
      canvas: getCanvasFingerprint(),
      audio: getAudioFingerprint()
    };

    const fingerprint = generateFingerprint(fingerprintData);
    $('fingerprint').textContent = fingerprint;

    // Estimate uniqueness
    const factors = [
      screen.width * screen.height,
      navigator.hardwareConcurrency || 4,
      screen.colorDepth,
      navigator.maxTouchPoints || 0,
      navigator.languages?.length || 1,
      fonts.length * 100
    ];
    const uniqueScore = factors.reduce((a, b) => a + b, 0);
    const uniqueEstimate = uniqueScore > 15000 ? '~1 in 286,777' : uniqueScore > 8000 ? '~1 in 50,000' : '~1 in 10,000';
    $('uniqueness').textContent = uniqueEstimate + ' browsers';

    updateProgress(100, 'Scan complete!');

    // Remove scan animations
    setTimeout(() => {
      document.querySelectorAll('.scan-animation').forEach(el => {
        el.classList.remove('scan-animation');
      });
    }, 500);
  }

  // Run scan on load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', runScan);
  } else {
    runScan();
  }
})();
</script>

</body>
</html>
