<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Awareness ‚Äî Peter Skaronis</title>
    <meta name="description" content="See what information websites can collect about you just by visiting. No cookies required.">
    <link rel="canonical" href="https://skaronis.com/awareness.html">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .page-intro {
            max-width: 600px;
            margin-bottom: 2rem;
        }

        .warning-banner {
            background: rgba(139, 198, 106, 0.1);
            border: 1px solid #8bc66a;
            border-radius: 8px;
            padding: 1.25rem 1.5rem;
            margin-bottom: 2rem;
        }

        .warning-banner h3 {
            color: #8bc66a;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .warning-banner p {
            font-size: 0.9rem;
            color: #b0b0b0;
            margin: 0;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #222;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: #8bc66a;
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .scan-status {
            text-align: center;
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 2rem;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: #111;
            border: 1px solid #222;
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 3px solid #8bc66a;
        }

        .card.danger {
            border-left-color: #d66a9a;
        }

        .card.warning {
            border-left-color: #d6a86a;
        }

        .card h2 {
            font-family: 'Instrument Serif', Georgia, serif;
            font-size: 1.25rem;
            font-weight: 400;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-icon {
            font-size: 1.25rem;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 0.5rem 0;
            border-bottom: 1px solid #1a1a1a;
        }

        .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            font-size: 0.85rem;
            color: #888;
        }

        .data-value {
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.8rem;
            color: #8bc66a;
            text-align: right;
            max-width: 55%;
            word-break: break-word;
        }

        .data-value.danger {
            color: #d66a9a;
        }

        .data-value.warning {
            color: #d6a86a;
        }

        .loading {
            color: #666;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-yes {
            background: #8bc66a;
        }

        .status-no {
            background: #d6a86a;
        }

        .extension-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-top: 0.75rem;
        }

        .extension-tag {
            background: #1a1a1a;
            border: 1px solid #333;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
        }

        .extension-tag.detected {
            background: rgba(214, 106, 154, 0.15);
            border-color: #d66a9a;
            color: #d66a9a;
        }

        .font-list {
            font-size: 0.7rem;
            max-height: 80px;
            overflow-y: auto;
            background: #0a0a0a;
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #222;
            margin-top: 0.5rem;
            color: #888;
        }

        .social-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.4rem;
            margin-top: 0.5rem;
        }

        .social-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.3rem 0.5rem;
            background: #1a1a1a;
            border-radius: 4px;
            font-size: 0.75rem;
            border: 1px solid #222;
        }

        .fingerprint-card {
            grid-column: 1 / -1;
        }

        .fingerprint-display {
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.65rem;
            word-break: break-all;
            background: #0a0a0a;
            padding: 0.75rem;
            border-radius: 4px;
            margin-top: 0.75rem;
            border: 1px solid #222;
            color: #8bc66a;
        }

        .threat-intel {
            margin-top: 1rem;
            padding-top: 0.75rem;
            border-top: 1px dashed #222;
        }

        .threat-toggle {
            background: none;
            border: 1px solid #333;
            color: #888;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            transition: all 0.2s ease;
        }

        .threat-toggle:hover {
            border-color: #8bc66a;
            color: #8bc66a;
        }

        .threat-toggle .arrow {
            transition: transform 0.2s ease;
            font-size: 0.5rem;
        }

        .threat-toggle.open .arrow {
            transform: rotate(90deg);
        }

        .threat-content {
            display: none;
            margin-top: 0.75rem;
            font-size: 0.8rem;
            line-height: 1.5;
            color: #888;
        }

        .threat-content.visible {
            display: block;
        }

        .threat-label {
            font-weight: 600;
            color: #d6a86a;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.25rem;
            margin-top: 0.5rem;
        }

        .threat-label:first-child {
            margin-top: 0;
        }

        .mitre-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin-top: 0.5rem;
        }

        .mitre-tag {
            background: rgba(106, 168, 214, 0.15);
            border: 1px solid #6aa8d6;
            color: #6aa8d6;
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            font-size: 0.6rem;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            text-decoration: none;
        }

        .mitre-tag:hover {
            background: rgba(106, 168, 214, 0.25);
        }

        .storage-section {
            margin-top: 0.75rem;
        }

        .storage-section h4 {
            font-size: 0.8rem;
            margin-bottom: 0.4rem;
            color: #888;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .storage-section .count {
            background: #8bc66a;
            color: #000;
            padding: 0.1rem 0.3rem;
            border-radius: 3px;
            font-size: 0.65rem;
        }

        .storage-list {
            background: #0a0a0a;
            border: 1px solid #222;
            border-radius: 4px;
            max-height: 120px;
            overflow-y: auto;
            font-size: 0.7rem;
        }

        .storage-item {
            padding: 0.4rem 0.6rem;
            border-bottom: 1px solid #1a1a1a;
        }

        .storage-item:last-child {
            border-bottom: none;
        }

        .storage-key {
            font-weight: 500;
            color: #8bc66a;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            word-break: break-all;
        }

        .storage-value {
            color: #666;
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            word-break: break-all;
            max-height: 40px;
            overflow: hidden;
        }

        .storage-item.sensitive {
            background: rgba(214, 106, 154, 0.08);
        }

        .storage-item.sensitive .storage-key {
            color: #d66a9a;
        }

        .sensitive-badge {
            display: inline-block;
            background: #d66a9a;
            color: #fff;
            font-size: 0.5rem;
            padding: 0.05rem 0.25rem;
            border-radius: 2px;
            margin-left: 0.4rem;
            text-transform: uppercase;
        }

        .storage-empty {
            padding: 0.6rem;
            text-align: center;
            color: #555;
            font-style: italic;
        }

        .refresh-btn {
            display: inline-block;
            background: #8bc66a;
            color: #000;
            padding: 0.75rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .refresh-btn:hover {
            opacity: 0.9;
        }

        .actions {
            text-align: center;
            margin: 2rem 0;
        }

        .disclaimer {
            text-align: center;
            font-size: 0.85rem;
            color: #666;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #222;
        }

        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }

            .data-value {
                max-width: 50%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="/" class="back-link">&larr; Home</a>
            <h1>Digital Awareness</h1>
            <p class="page-intro">See what information websites can collect about you just by visiting. No cookies required - this is all from your browser.</p>
        </header>

        <div class="warning-banner">
            <h3>Why does this matter?</h3>
            <p>Every website you visit can access this information. Combined, these data points create a unique "fingerprint" that can track you across the web - even without cookies.</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="scanProgress" style="width: 0%"></div>
        </div>
        <p class="scan-status" id="scanStatus">Initializing scan...</p>

        <div class="cards-grid">
            <!-- Network Information -->
            <div class="card">
                <h2><span class="card-icon">üåê</span> Network</h2>
                <div class="data-row">
                    <span class="data-label">Public IP</span>
                    <span class="data-value" id="ip"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Location (approx)</span>
                    <span class="data-value" id="location"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">ISP / Org</span>
                    <span class="data-value" id="isp"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Connection Type</span>
                    <span class="data-value" id="connectionType"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Downlink Speed</span>
                    <span class="data-value" id="downlink"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>IP reveals physical location, ISP, and organization. Attackers use this for geotargeting, identifying corporate networks, and VPN detection.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Location-based phishing, ISP-specific exploits, network reconnaissance for targeted attacks.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1590/" target="_blank" class="mitre-tag">T1590: Gather Victim Network Info</a>
                            <a href="https://attack.mitre.org/techniques/T1016/" target="_blank" class="mitre-tag">T1016: System Network Config</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Privacy Leaks -->
            <div class="card danger">
                <h2><span class="card-icon">üö®</span> Privacy Leaks</h2>
                <div class="data-row">
                    <span class="data-label">Local IP (WebRTC)</span>
                    <span class="data-value" id="localIP"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Private Browsing</span>
                    <span class="data-value" id="incognito"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Referrer</span>
                    <span class="data-value" id="referrer"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Canvas Fingerprint</span>
                    <span class="data-value" id="canvasHash"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Audio Fingerprint</span>
                    <span class="data-value" id="audioHash"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>WebRTC leaks reveal internal network structure. Canvas/audio fingerprints create unique identifiers that persist across sessions and sites.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Cross-site tracking without cookies, identifying users even in incognito mode, internal network mapping for lateral movement.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1016/" target="_blank" class="mitre-tag">T1016: Network Config Discovery</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Browser Information -->
            <div class="card">
                <h2><span class="card-icon">üîç</span> Browser</h2>
                <div class="data-row">
                    <span class="data-label">Browser</span>
                    <span class="data-value" id="browser"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Engine</span>
                    <span class="data-value" id="engine"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Language</span>
                    <span class="data-value" id="language"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Cookies Enabled</span>
                    <span class="data-value" id="cookies"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Do Not Track</span>
                    <span class="data-value" id="dnt"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Ad Blocker</span>
                    <span class="data-value" id="adblock"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Browser version reveals potential vulnerabilities. Language preferences indicate nationality/location. Ad blocker detection affects malvertising strategies.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Browser-specific exploits (CVEs), language-targeted phishing, evading ad blocker detection for malicious ads.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1189/" target="_blank" class="mitre-tag">T1189: Drive-by Compromise</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extensions & Plugins -->
            <div class="card warning">
                <h2><span class="card-icon">üß©</span> Extensions & Plugins</h2>
                <div class="data-row">
                    <span class="data-label">PDF Viewer</span>
                    <span class="data-value" id="pdfViewer"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Plugins Count</span>
                    <span class="data-value" id="pluginsCount"><span class="loading">Detecting...</span></span>
                </div>
                <p style="font-size:.75rem;color:#666;margin-top:.75rem;">Detected Extensions:</p>
                <div class="extension-list" id="extensionList">
                    <span class="loading">Scanning...</span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Extensions reveal security awareness (ad blockers), profession (dev tools), crypto holdings (wallets), and password management habits.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Extension-specific vulnerabilities, targeting crypto wallet users, exploiting password manager weaknesses, bypassing security extensions.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1176/" target="_blank" class="mitre-tag">T1176: Browser Extensions</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social Logins -->
            <div class="card danger">
                <h2><span class="card-icon">üë§</span> Social Login Detection</h2>
                <p style="font-size:.75rem;color:#666;margin-bottom:.5rem;">Sites can detect if you're logged into these services:</p>
                <div class="social-grid" id="socialGrid">
                    <span class="loading">Checking...</span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Reveals active accounts and services used. Confirms identity across platforms and indicates personal/professional tools.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Targeted phishing for specific services, credential stuffing prioritization, social engineering with confirmed account knowledge.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1589/" target="_blank" class="mitre-tag">T1589: Gather Victim Identity</a>
                            <a href="https://attack.mitre.org/techniques/T1566/" target="_blank" class="mitre-tag">T1566: Phishing</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Information -->
            <div class="card">
                <h2><span class="card-icon">üíª</span> System</h2>
                <div class="data-row">
                    <span class="data-label">Operating System</span>
                    <span class="data-value" id="os"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Platform</span>
                    <span class="data-value" id="platform"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">CPU Cores</span>
                    <span class="data-value" id="cores"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Device Memory</span>
                    <span class="data-value" id="memory"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Touch Support</span>
                    <span class="data-value" id="touch"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Device Type</span>
                    <span class="data-value" id="deviceType"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>OS version reveals patch level and potential vulnerabilities. CPU cores and memory indicate device value and processing capabilities.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>OS-specific exploits, device-targeted malware, identifying high-value targets, tailoring payloads to available resources.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1592/" target="_blank" class="mitre-tag">T1592: Gather Victim Host Info</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Display Information -->
            <div class="card">
                <h2><span class="card-icon">üñ•Ô∏è</span> Display</h2>
                <div class="data-row">
                    <span class="data-label">Screen Resolution</span>
                    <span class="data-value" id="screenRes"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Available Screen</span>
                    <span class="data-value" id="availScreen"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Viewport Size</span>
                    <span class="data-value" id="viewport"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Color Depth</span>
                    <span class="data-value" id="colorDepth"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Pixel Ratio</span>
                    <span class="data-value" id="pixelRatio"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">HDR Support</span>
                    <span class="data-value" id="hdr"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Screen resolution and available screen area reveal monitor setup, taskbar position, and potential multi-monitor configuration.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Crafting phishing pages that match victim's resolution, detecting virtual machines (unusual resolutions).</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1497/" target="_blank" class="mitre-tag">T1497: Virtualization/Sandbox Evasion</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Graphics Information -->
            <div class="card">
                <h2><span class="card-icon">üéÆ</span> Graphics</h2>
                <div class="data-row">
                    <span class="data-label">GPU Vendor</span>
                    <span class="data-value" id="gpuVendor"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">GPU Renderer</span>
                    <span class="data-value" id="gpuRenderer"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">WebGL Version</span>
                    <span class="data-value" id="webgl"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Max Texture Size</span>
                    <span class="data-value" id="maxTexture"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>GPU details are highly unique identifiers. Specific GPU models indicate device age, value, and gaming/professional use.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>VM/sandbox detection to evade security researchers, GPU-specific exploits, cryptojacking capability assessment.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1497/" target="_blank" class="mitre-tag">T1497: Virtualization/Sandbox Evasion</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fonts -->
            <div class="card warning">
                <h2><span class="card-icon">üî§</span> Font Fingerprinting</h2>
                <div class="data-row">
                    <span class="data-label">Detected Fonts</span>
                    <span class="data-value" id="fontCount"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Font Hash</span>
                    <span class="data-value" id="fontHash"><span class="loading">Detecting...</span></span>
                </div>
                <p style="font-size:.7rem;color:#666;margin-top:.5rem;">Sample of detected fonts:</p>
                <div class="font-list" id="fontList">
                    <span class="loading">Enumerating fonts...</span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Installed fonts are extremely unique. Professional software installs distinctive fonts. Developer fonts reveal coding activity.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Highly reliable cross-session tracking, identifying professionals by software fonts, persistent identification despite cookie clearing.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1518/" target="_blank" class="mitre-tag">T1518: Software Discovery</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Time & Location -->
            <div class="card">
                <h2><span class="card-icon">üïê</span> Time & Locale</h2>
                <div class="data-row">
                    <span class="data-label">Timezone</span>
                    <span class="data-value" id="timezone"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">UTC Offset</span>
                    <span class="data-value" id="utcOffset"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Local Time</span>
                    <span class="data-value" id="localTime"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Date Format</span>
                    <span class="data-value" id="dateFormat"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Timezone confirms physical location even with VPN. Date/time format reveals cultural background.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Timing attacks based on victim's active hours, VPN detection (timezone mismatch with IP), scheduling phishing for optimal response times.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1124/" target="_blank" class="mitre-tag">T1124: System Time Discovery</a>
                            <a href="https://attack.mitre.org/techniques/T1614/" target="_blank" class="mitre-tag">T1614: System Location Discovery</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Battery & Power -->
            <div class="card">
                <h2><span class="card-icon">üîã</span> Battery</h2>
                <div class="data-row">
                    <span class="data-label">Battery Level</span>
                    <span class="data-value" id="batteryLevel"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Charging Status</span>
                    <span class="data-value" id="charging"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Time to Full</span>
                    <span class="data-value" id="chargingTime"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Time to Empty</span>
                    <span class="data-value" id="dischargingTime"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Battery status reveals mobile vs. desktop use. Charging patterns indicate user behavior. Low battery users may make hasty security decisions.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Urgency-based phishing when battery is low, device type confirmation, identifying mobile targets for SMS phishing.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1082/" target="_blank" class="mitre-tag">T1082: System Information Discovery</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Storage & Features -->
            <div class="card">
                <h2><span class="card-icon">üíæ</span> Storage & Features</h2>
                <div class="data-row">
                    <span class="data-label">Local Storage</span>
                    <span class="data-value" id="localStorage"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Session Storage</span>
                    <span class="data-value" id="sessionStorage"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">IndexedDB</span>
                    <span class="data-value" id="indexedDB"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Web Workers</span>
                    <span class="data-value" id="webWorkers"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Service Workers</span>
                    <span class="data-value" id="serviceWorkers"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Storage capabilities indicate browser features and potential for persistent tracking. Service Worker support enables background execution.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Persistent malware via Service Workers, evercookies using multiple storage mechanisms, offline attack payloads.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1185/" target="_blank" class="mitre-tag">T1185: Browser Session Hijacking</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Storage Inspector -->
            <div class="card danger">
                <h2><span class="card-icon">üóÉÔ∏è</span> Storage Inspector</h2>
                <p style="font-size:.75rem;color:#666;margin-bottom:.5rem;">Any website can read all data stored in your browser for their domain:</p>
                <div class="data-row">
                    <span class="data-label">Total Items</span>
                    <span class="data-value" id="storageCount"><span class="loading">Scanning...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Sensitive Items</span>
                    <span class="data-value" id="sensitiveCount"><span class="loading">Scanning...</span></span>
                </div>
                <div class="storage-section">
                    <h4>LocalStorage <span class="count" id="localStorageCount">0</span></h4>
                    <div class="storage-list" id="localStorageList">
                        <div class="storage-empty">Scanning...</div>
                    </div>
                </div>
                <div class="storage-section">
                    <h4>SessionStorage <span class="count" id="sessionStorageCount">0</span></h4>
                    <div class="storage-list" id="sessionStorageList">
                        <div class="storage-empty">Scanning...</div>
                    </div>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Stored data often contains authentication tokens, user preferences, tracking IDs, and cached personal information.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>XSS payload stealing tokens/sessions, persistent tracking via stored identifiers, account takeover via stolen auth tokens.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1185/" target="_blank" class="mitre-tag">T1185: Browser Session Hijacking</a>
                            <a href="https://attack.mitre.org/techniques/T1539/" target="_blank" class="mitre-tag">T1539: Steal Web Session Cookie</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Media Capabilities -->
            <div class="card">
                <h2><span class="card-icon">üéµ</span> Media</h2>
                <div class="data-row">
                    <span class="data-label">Audio Formats</span>
                    <span class="data-value" id="audioFormats"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Video Formats</span>
                    <span class="data-value" id="videoFormats"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">WebRTC Support</span>
                    <span class="data-value" id="webrtc"><span class="loading">Detecting...</span></span>
                </div>
                <div class="data-row">
                    <span class="data-label">Media Devices</span>
                    <span class="data-value" id="mediaDevices"><span class="loading">Detecting...</span></span>
                </div>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Media capabilities indicate device type and codec support. WebRTC reveals camera/microphone presence.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Identifying targets with cameras, codec-based fingerprinting, unauthorized media access attempts via permission prompts.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1125/" target="_blank" class="mitre-tag">T1125: Video Capture</a>
                            <a href="https://attack.mitre.org/techniques/T1123/" target="_blank" class="mitre-tag">T1123: Audio Capture</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fingerprint -->
            <div class="card fingerprint-card">
                <h2><span class="card-icon">üîê</span> Your Browser Fingerprint</h2>
                <p style="color:#888;font-size:.85rem;">This hash is generated from your browser characteristics. It's likely unique to you among millions of users.</p>
                <div class="fingerprint-display" id="fingerprint">
                    <span class="loading">Calculating fingerprint...</span>
                </div>
                <p style="margin-top:1rem;font-size:.8rem;color:#666;">Uniqueness estimate: <strong id="uniqueness" style="color:#8bc66a">Calculating...</strong></p>
                <div class="threat-intel">
                    <button class="threat-toggle" onclick="this.classList.toggle('open');this.nextElementSibling.classList.toggle('visible')"><span class="arrow">‚ñ∂</span> Threat Intel</button>
                    <div class="threat-content">
                        <div class="threat-label">OSINT Value</div>
                        <p>Browser fingerprinting combines all collected data into a unique identifier that persists across sessions, VPNs, and cookie clearing.</p>
                        <div class="threat-label">Attack Vectors</div>
                        <p>Persistent cross-site tracking, identifying users despite privacy measures, linking anonymous accounts to real identities.</p>
                        <div class="mitre-tags">
                            <a href="https://attack.mitre.org/techniques/T1592/" target="_blank" class="mitre-tag">T1592: Gather Victim Host Info</a>
                            <a href="https://attack.mitre.org/techniques/T1589/" target="_blank" class="mitre-tag">T1589: Gather Victim Identity</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="refresh-btn" onclick="location.reload()">Scan Again</button>
        </div>

        <div class="disclaimer">
            <p>This tool is for educational purposes only. No data is stored or transmitted.</p>
        </div>

        <footer class="with-border">
            <div class="footer-links">
                <a href="/">Home</a>
                <a href="/now.html">Now</a>
                <a href="https://x.com/peter_skaronis">Twitter</a>
                <a href="https://www.linkedin.com/in/peterskaronis/">LinkedIn</a>
            </div>
            <p class="copyright">Made in Vancouver üá®üá¶</p>
        </footer>
    </div>

<script>
(function() {
  const $ = id => document.getElementById(id);
  const progress = $('scanProgress');
  const status = $('scanStatus');

  function updateProgress(value, message) {
    progress.style.width = value + '%';
    status.textContent = message;
  }

  function setValue(id, value, className) {
    const el = $(id);
    if (el) {
      el.textContent = value || 'Not available';
      if (className) el.className = 'data-value ' + className;
    }
  }

  function setStatus(id, isEnabled) {
    const el = $(id);
    if (el) {
      el.innerHTML = '<span class="status-indicator ' + (isEnabled ? 'status-yes' : 'status-no') + '"></span>' + (isEnabled ? 'Yes' : 'No');
    }
  }

  function simpleHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash = hash & hash;
    }
    return Math.abs(hash).toString(16).padStart(8, '0');
  }

  function detectBrowser() {
    const ua = navigator.userAgent;
    let browser = 'Unknown', version = '';
    if (ua.includes('Firefox/')) { browser = 'Firefox'; version = (ua.match(/Firefox\/(\d+)/) || [])[1] || ''; }
    else if (ua.includes('Edg/')) { browser = 'Edge'; version = (ua.match(/Edg\/(\d+)/) || [])[1] || ''; }
    else if (ua.includes('Chrome/')) { browser = 'Chrome'; version = (ua.match(/Chrome\/(\d+)/) || [])[1] || ''; }
    else if (ua.includes('Safari/') && !ua.includes('Chrome')) { browser = 'Safari'; version = (ua.match(/Version\/(\d+)/) || [])[1] || ''; }
    return browser + (version ? ' ' + version : '');
  }

  function detectOS() {
    const ua = navigator.userAgent;
    if (ua.includes('Windows NT 10')) return 'Windows 10/11';
    if (ua.includes('Mac OS X')) return 'macOS';
    if (ua.includes('Android')) return 'Android';
    if (ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
    if (ua.includes('Linux')) return 'Linux';
    return navigator.platform || 'Unknown';
  }

  function detectEngine() {
    const ua = navigator.userAgent;
    if (ua.includes('Gecko/')) return 'Gecko (Firefox)';
    if (ua.includes('AppleWebKit/')) return ua.includes('Chrome/') ? 'Blink (Chromium)' : 'WebKit (Safari)';
    return 'Unknown';
  }

  function detectDeviceType() {
    const ua = navigator.userAgent;
    if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) return 'Tablet';
    if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated/.test(ua)) return 'Mobile';
    return 'Desktop';
  }

  function getWebGLInfo() {
    try {
      const canvas = document.createElement('canvas');
      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      if (!gl) return { vendor: 'Not supported', renderer: 'Not supported', version: 'Not supported', maxTexture: 'N/A' };
      const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
      return {
        vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : gl.getParameter(gl.VENDOR),
        renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : gl.getParameter(gl.RENDERER),
        version: gl.getParameter(gl.VERSION),
        maxTexture: gl.getParameter(gl.MAX_TEXTURE_SIZE) + 'px'
      };
    } catch(e) { return { vendor: 'Error', renderer: 'Error', version: 'Error', maxTexture: 'Error' }; }
  }

  async function getLocalIPs() {
    const ips = new Set();
    try {
      const pc = new RTCPeerConnection({ iceServers: [] });
      pc.createDataChannel('');
      await pc.setLocalDescription(await pc.createOffer());
      return new Promise(resolve => {
        const timeout = setTimeout(() => { pc.close(); resolve(Array.from(ips)); }, 2000);
        pc.onicecandidate = e => {
          if (!e.candidate) { clearTimeout(timeout); pc.close(); resolve(Array.from(ips)); return; }
          const match = e.candidate.candidate.match(/(\d+\.\d+\.\d+\.\d+)/);
          if (match && !match[1].startsWith('0.')) ips.add(match[1]);
        };
      });
    } catch(e) { return []; }
  }

  async function detectIncognito() {
    if ('storage' in navigator && 'estimate' in navigator.storage) {
      try { const { quota } = await navigator.storage.estimate(); if (quota && quota < 120000000) return true; } catch(e) {}
    }
    return false;
  }

  function getCanvasFingerprint() {
    try {
      const canvas = document.createElement('canvas');
      canvas.width = 200; canvas.height = 50;
      const ctx = canvas.getContext('2d');
      ctx.textBaseline = 'top'; ctx.font = '14px Arial';
      ctx.fillStyle = '#f60'; ctx.fillRect(125, 1, 62, 20);
      ctx.fillStyle = '#069'; ctx.fillText('Cwm fjord', 2, 15);
      ctx.fillStyle = 'rgba(102, 204, 0, 0.7)'; ctx.fillText('Cwm fjord', 4, 17);
      return simpleHash(canvas.toDataURL()).toUpperCase();
    } catch(e) { return 'Not available'; }
  }

  function getAudioFingerprint() {
    try {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = ctx.createOscillator();
      const analyser = ctx.createAnalyser();
      const gain = ctx.createGain();
      gain.gain.value = 0; osc.type = 'triangle';
      osc.connect(analyser); analyser.connect(gain); gain.connect(ctx.destination);
      osc.start(0);
      const bins = new Float32Array(analyser.frequencyBinCount);
      analyser.getFloatFrequencyData(bins);
      osc.stop(); ctx.close();
      return simpleHash(bins.slice(0, 30).join(',')).toUpperCase();
    } catch(e) { return 'Not available'; }
  }

  function detectFonts() {
    const baseFonts = ['monospace', 'sans-serif', 'serif'];
    const testFonts = ['Arial', 'Arial Black', 'Calibri', 'Cambria', 'Comic Sans MS', 'Consolas', 'Courier New', 'Georgia', 'Helvetica', 'Impact', 'Lucida Console', 'Monaco', 'Segoe UI', 'Tahoma', 'Times New Roman', 'Trebuchet MS', 'Verdana', 'Roboto', 'Open Sans', 'Fira Code', 'JetBrains Mono', 'SF Pro', 'SF Mono', 'Menlo'];
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const testString = 'mmmmmmmmmmlli';
    const baseWidths = {};
    baseFonts.forEach(font => { ctx.font = '72px ' + font; baseWidths[font] = ctx.measureText(testString).width; });
    const detected = [];
    testFonts.forEach(font => {
      for (const baseFont of baseFonts) {
        ctx.font = '72px "' + font + '", ' + baseFont;
        if (ctx.measureText(testString).width !== baseWidths[baseFont]) { detected.push(font); break; }
      }
    });
    return detected;
  }

  async function detectExtensions() {
    const detected = [];
    const checks = [
      { check: () => window.__REACT_DEVTOOLS_GLOBAL_HOOK__, name: 'React DevTools' },
      { check: () => window.__VUE_DEVTOOLS_GLOBAL_HOOK__, name: 'Vue DevTools' },
      { check: () => window.ethereum, name: 'Web3 Wallet' },
      { check: () => window.Grammarly, name: 'Grammarly' }
    ];
    for (const { check, name } of checks) { try { if (check()) detected.push(name); } catch(e) {} }
    const bait = document.createElement('div');
    bait.className = 'ad ads adsbox ad-banner';
    bait.style.cssText = 'position:absolute;left:-9999px;width:1px;height:1px;';
    document.body.appendChild(bait);
    await new Promise(r => setTimeout(r, 100));
    if (bait.offsetHeight === 0 || getComputedStyle(bait).display === 'none') detected.push('Ad Blocker');
    document.body.removeChild(bait);
    return [...new Set(detected)];
  }

  async function detectSocialLogins() {
    return [
      { name: 'Google', icon: 'üîç' }, { name: 'Facebook', icon: 'üìò' }, { name: 'Twitter/X', icon: 'üê¶' },
      { name: 'LinkedIn', icon: 'üíº' }, { name: 'GitHub', icon: 'üêô' }, { name: 'Amazon', icon: 'üì¶' }
    ];
  }

  function checkAudioFormats() {
    const audio = document.createElement('audio');
    const formats = [];
    if (audio.canPlayType('audio/mpeg')) formats.push('MP3');
    if (audio.canPlayType('audio/ogg')) formats.push('OGG');
    if (audio.canPlayType('audio/wav')) formats.push('WAV');
    return formats.join(', ') || 'None';
  }

  function checkVideoFormats() {
    const video = document.createElement('video');
    const formats = [];
    if (video.canPlayType('video/mp4')) formats.push('MP4');
    if (video.canPlayType('video/webm')) formats.push('WebM');
    return formats.join(', ') || 'None';
  }

  function inspectStorage() {
    const sensitivePatterns = [/token/i, /auth/i, /session/i, /password/i, /key/i, /jwt/i, /email/i, /user/i];
    function isSensitive(key, value) { return sensitivePatterns.some(p => p.test(key + ' ' + value)); }
    function escapeHtml(str) { const div = document.createElement('div'); div.textContent = str; return div.innerHTML; }
    function renderStorage(storage, listEl, countEl) {
      const items = [];
      let sensitiveCount = 0;
      try {
        for (let i = 0; i < storage.length; i++) {
          const key = storage.key(i);
          const value = storage.getItem(key);
          const sensitive = isSensitive(key, value);
          if (sensitive) sensitiveCount++;
          items.push({ key, value: value.slice(0, 100), sensitive });
        }
      } catch(e) { listEl.innerHTML = '<div class="storage-empty">Unable to read</div>'; countEl.textContent = '0'; return { total: 0, sensitive: 0 }; }
      countEl.textContent = items.length;
      if (items.length === 0) listEl.innerHTML = '<div class="storage-empty">Empty</div>';
      else listEl.innerHTML = items.map(i => '<div class="storage-item' + (i.sensitive ? ' sensitive' : '') + '"><div class="storage-key">' + escapeHtml(i.key) + (i.sensitive ? '<span class="sensitive-badge">Sensitive</span>' : '') + '</div><div class="storage-value">' + escapeHtml(i.value) + '</div></div>').join('');
      return { total: items.length, sensitive: sensitiveCount };
    }
    const local = renderStorage(localStorage, $('localStorageList'), $('localStorageCount'));
    const session = renderStorage(sessionStorage, $('sessionStorageList'), $('sessionStorageCount'));
    setValue('storageCount', (local.total + session.total) + ' items');
    if (local.sensitive + session.sensitive > 0) setValue('sensitiveCount', (local.sensitive + session.sensitive) + ' found!', 'danger');
    else setValue('sensitiveCount', 'None detected');
  }

  function generateFingerprint(data) {
    const str = JSON.stringify(data);
    return (simpleHash(str) + '-' + simpleHash(str.split('').reverse().join(''))).toUpperCase();
  }

  async function runScan() {
    updateProgress(5, 'Detecting browser...');
    setValue('browser', detectBrowser());
    setValue('engine', detectEngine());
    setValue('language', navigator.languages ? navigator.languages.join(', ') : navigator.language);
    setStatus('cookies', navigator.cookieEnabled);
    setValue('dnt', navigator.doNotTrack === '1' ? 'Enabled' : 'Disabled');

    updateProgress(15, 'Checking privacy leaks...');
    const localIPs = await getLocalIPs();
    setValue('localIP', localIPs.length > 0 ? localIPs.join(', ') : 'Protected', localIPs.length > 0 ? 'danger' : '');
    const isIncognito = await detectIncognito();
    setValue('incognito', isIncognito ? 'Yes - Detected!' : 'No', isIncognito ? 'danger' : '');
    setValue('referrer', document.referrer || 'Direct visit');
    setValue('canvasHash', getCanvasFingerprint(), 'warning');
    setValue('audioHash', getAudioFingerprint(), 'warning');

    updateProgress(30, 'Detecting system...');
    setValue('os', detectOS());
    setValue('platform', navigator.platform);
    setValue('cores', navigator.hardwareConcurrency || 'N/A');
    setValue('memory', navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'N/A');
    setValue('touch', navigator.maxTouchPoints > 0 ? 'Yes (' + navigator.maxTouchPoints + ' points)' : 'No');
    setValue('deviceType', detectDeviceType());

    updateProgress(40, 'Detecting display...');
    setValue('screenRes', screen.width + ' x ' + screen.height);
    setValue('availScreen', screen.availWidth + ' x ' + screen.availHeight);
    setValue('viewport', window.innerWidth + ' x ' + window.innerHeight);
    setValue('colorDepth', screen.colorDepth + '-bit');
    setValue('pixelRatio', window.devicePixelRatio + 'x');
    setValue('hdr', window.matchMedia('(dynamic-range: high)').matches ? 'Supported' : 'No');

    updateProgress(50, 'Detecting graphics...');
    const webgl = getWebGLInfo();
    setValue('gpuVendor', webgl.vendor);
    setValue('gpuRenderer', webgl.renderer);
    setValue('webgl', webgl.version);
    setValue('maxTexture', webgl.maxTexture);

    updateProgress(60, 'Enumerating fonts...');
    const fonts = detectFonts();
    setValue('fontCount', fonts.length + ' fonts', 'warning');
    setValue('fontHash', simpleHash(fonts.join(',')).toUpperCase(), 'warning');
    $('fontList').textContent = fonts.slice(0, 15).join(', ') + (fonts.length > 15 ? '...' : '');

    updateProgress(70, 'Detecting extensions...');
    setValue('pdfViewer', navigator.pdfViewerEnabled ? 'Built-in' : 'External/None');
    setValue('pluginsCount', navigator.plugins ? navigator.plugins.length + ' plugins' : 'N/A');
    const extensions = await detectExtensions();
    $('extensionList').innerHTML = extensions.length > 0 ? extensions.map(e => '<span class="extension-tag detected">' + e + '</span>').join('') : '<span style="color:#666;font-size:.75rem;">None detected</span>';

    updateProgress(75, 'Checking social logins...');
    const social = await detectSocialLogins();
    $('socialGrid').innerHTML = social.map(s => '<div class="social-item"><span>' + s.icon + '</span>' + s.name + '</div>').join('');

    updateProgress(80, 'Detecting time & locale...');
    setValue('timezone', Intl.DateTimeFormat().resolvedOptions().timeZone);
    const offset = new Date().getTimezoneOffset();
    setValue('utcOffset', 'UTC' + (offset <= 0 ? '+' : '-') + Math.abs(offset / 60));
    setValue('localTime', new Date().toLocaleTimeString());
    setValue('dateFormat', new Date().toLocaleDateString());

    updateProgress(85, 'Checking storage...');
    setStatus('localStorage', !!window.localStorage);
    setStatus('sessionStorage', !!window.sessionStorage);
    setStatus('indexedDB', !!window.indexedDB);
    setStatus('webWorkers', !!window.Worker);
    setStatus('serviceWorkers', 'serviceWorker' in navigator);
    inspectStorage();

    updateProgress(88, 'Detecting media...');
    setValue('audioFormats', checkAudioFormats());
    setValue('videoFormats', checkVideoFormats());
    setStatus('webrtc', !!window.RTCPeerConnection);
    setValue('mediaDevices', navigator.mediaDevices ? 'Available' : 'N/A');

    const hasAdBlocker = extensions.includes('Ad Blocker');
    setValue('adblock', hasAdBlocker ? 'Detected' : 'Not detected');

    updateProgress(90, 'Detecting battery...');
    if ('getBattery' in navigator) {
      try {
        const battery = await navigator.getBattery();
        setValue('batteryLevel', Math.round(battery.level * 100) + '%');
        setValue('charging', battery.charging ? 'Yes' : 'No');
        setValue('chargingTime', battery.chargingTime === Infinity ? 'N/A' : Math.round(battery.chargingTime / 60) + ' min');
        setValue('dischargingTime', battery.dischargingTime === Infinity ? 'N/A' : Math.round(battery.dischargingTime / 60) + ' min');
      } catch(e) { setValue('batteryLevel', 'N/A'); setValue('charging', 'N/A'); setValue('chargingTime', 'N/A'); setValue('dischargingTime', 'N/A'); }
    } else { setValue('batteryLevel', 'Not supported'); setValue('charging', 'Not supported'); setValue('chargingTime', 'Not supported'); setValue('dischargingTime', 'Not supported'); }

    updateProgress(93, 'Fetching network info...');
    if ('connection' in navigator) {
      setValue('connectionType', navigator.connection.effectiveType ? navigator.connection.effectiveType.toUpperCase() : 'Unknown');
      setValue('downlink', navigator.connection.downlink ? navigator.connection.downlink + ' Mbps' : 'Unknown');
    } else { setValue('connectionType', 'Not supported'); setValue('downlink', 'Not supported'); }

    try {
      const r = await fetch('https://ipapi.co/json/');
      const data = await r.json();
      setValue('ip', data.ip);
      setValue('location', data.city + ', ' + data.region + ', ' + data.country_name);
      setValue('isp', data.org);
    } catch(e) { setValue('ip', 'Could not fetch'); setValue('location', 'Could not fetch'); setValue('isp', 'Could not fetch'); }

    updateProgress(98, 'Generating fingerprint...');
    const fpData = { browser: detectBrowser(), os: detectOS(), screen: screen.width + 'x' + screen.height, timezone: Intl.DateTimeFormat().resolvedOptions().timeZone, language: navigator.language, cores: navigator.hardwareConcurrency, gpu: webgl.renderer, fonts: fonts.length, canvas: getCanvasFingerprint() };
    $('fingerprint').textContent = generateFingerprint(fpData);
    const score = screen.width * screen.height + (navigator.hardwareConcurrency || 4) * 1000 + fonts.length * 100;
    $('uniqueness').textContent = score > 15000 ? '~1 in 286,777 browsers' : '~1 in 50,000 browsers';

    updateProgress(100, 'Scan complete!');
  }

  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', runScan);
  else runScan();
})();
</script>
</body>
</html>
